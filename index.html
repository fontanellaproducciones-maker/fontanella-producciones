<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fontanella Producciones - Ane Miren Lafuente</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap');
        .font-display{font-family:'Playfair Display',serif}.font-body{font-family:'Inter',sans-serif}.gradient-gold{background:linear-gradient(135deg,#f59e0b 0%,#eab308 50%,#ca8a04 100%)}        .text-gradient{background:linear-gradient(135deg,#fbbf24,#fde047,#fb923c);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.floating{animation:floating 6s ease-in-out infinite}@keyframes floating{0%,100%{transform:translateY(0px)}50%{transform:translateY(-20px)}}.service-card{background:white;border-radius:20px;border:1px solid #e5e7eb;transition:all .3s ease}.service-card:hover{transform:translateY(-5px);box-shadow:0 20px 40px rgba(0,0,0,0.1);border-color:#f59e0b}.testimonial-card{background:white;border-radius:25px;border:1px solid #e5e7eb;position:relative}.testimonial-card::before{content:'"';position:absolute;top:-10px;left:20px;font-size:6rem;color:rgba(245,158,11,0.1);font-family:'Playfair Display',serif;line-height:1}.editable{position:relative;cursor:pointer;transition:all .3s ease}.admin-mode .editable:hover{outline:2px dashed #f59e0b;outline-offset:2px;background-color:rgba(245,158,11,0.1)}.edit-overlay,.delete-overlay{position:absolute;top:-10px;color:white;border-radius:50%;width:30px;height:30px;display:flex;align-items:center;justify-content:center;font-size:12px;opacity:0;transition:all .3s ease;z-index:10}.edit-overlay{right:-10px;background:#f59e0b}.delete-overlay{left:-10px;background:#ef4444;cursor:pointer}.delete-overlay:hover{background:#dc2626;transform:scale(1.1)}.admin-mode .editable:hover .edit-overlay,.admin-mode .editable:hover .delete-overlay{opacity:1}.gallery-item{position:relative;overflow:hidden;border-radius:12px;cursor:pointer;transition:all .3s ease}.gallery-item:hover{transform:scale(1.05)}.gallery-item img,.gallery-item video{width:100%;height:256px;object-fit:cover}.gallery-overlay{position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,0.8),transparent);opacity:0;transition:all .3s ease;display:flex;align-items:end;padding:1rem}.gallery-item:hover .gallery-overlay{opacity:1}.notification{position:fixed;top:100px;right:20px;padding:1rem 1.5rem;border-radius:8px;color:white;z-index:1000;animation:slideIn .3s ease}@keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}.success{background:#10b981}.error{background:#ef4444}.warning{background:#f59e0b}.deleted-placeholder{background:#fee2e2;border:2px dashed #ef4444;padding:2rem;border-radius:12px;text-align:center;color:#991b1b}.add-new-btn{position:fixed;bottom:30px;right:30px;width:60px;height:60px;background:linear-gradient(135deg,#f59e0b,#eab308);border-radius:50%;box-shadow:0 10px 30px rgba(245,158,11,0.4);display:none;align-items:center;justify-content:center;color:white;font-size:24px;cursor:pointer;transition:all .3s ease;z-index:30}.add-new-btn:hover{transform:scale(1.1);box-shadow:0 15px 40px rgba(245,158,11,0.6)}.admin-mode .add-new-btn{display:flex}.section-add-btn{display:none;margin:20px auto;padding:12px 24px;background:linear-gradient(135deg,#10b981,#059669);color:white;border-radius:12px;font-weight:600;cursor:pointer;transition:all .3s ease}.admin-mode .section-add-btn{display:block}.section-add-btn:hover{transform:translateY(-2px);box-shadow:0 10px 20px rgba(16,185,129,0.3)}
    </style>
</head>
<body class="font-body bg-gradient-to-br from-slate-50 via-amber-50 to-orange-50">
    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-3xl max-w-md w-full p-8 shadow-2xl">
            <h3 class="text-2xl font-display font-bold mb-6 text-center text-gray-800">Acceso de Administración</h3>
            <div class="mb-6">
                <input type="password" id="admin-password" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none" placeholder="Contraseña">
            </div>
            <div class="flex gap-3">
                <button id="login-btn" class="gradient-gold text-white px-6 py-3 rounded-2xl hover:shadow-lg transition-all flex-1 font-medium">Acceder</button>
                <button id="cancel-login-btn" class="bg-gray-500 text-white px-6 py-3 rounded-2xl hover:bg-gray-600 transition-all flex-1 font-medium">Cancelar</button>
            </div>
            <div id="login-error" class="mt-4 text-red-500 text-sm text-center hidden">Contraseña incorrecta. Inténtalo de nuevo.</div>
        </div>
    </div>

    <!-- Delete Modal -->
    <div id="delete-modal" class="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-3xl max-w-md w-full p-8 shadow-2xl">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-trash text-red-600 text-2xl"></i>
                </div>
                <h3 class="text-2xl font-display font-bold text-gray-800 mb-2">¿Eliminar elemento?</h3>
                <p class="text-gray-600">Esta acción no se puede deshacer</p>
            </div>
            <div class="flex gap-3">
                <button id="confirm-delete-btn" class="bg-red-600 text-white px-6 py-3 rounded-2xl hover:bg-red-700 transition-all flex-1 font-medium">Eliminar</button>
                <button id="cancel-delete-btn" class="bg-gray-500 text-white px-6 py-3 rounded-2xl hover:bg-gray-600 transition-all flex-1 font-medium">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="edit-modal" class="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-3xl max-w-3xl w-full p-8 max-h-[90vh] overflow-y-auto shadow-2xl">
            <h3 class="text-2xl font-display font-bold mb-6 text-gray-800">Editor de Contenido</h3>
            <div id="text-edit-section" class="mb-6">
                <label class="block text-sm font-medium mb-2 text-gray-700">Contenido:</label>
                <textarea id="edit-textarea" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none h-32 resize-none"></textarea>
            </div>
            <div id="media-section" class="mb-6">
                <h4 class="text-lg font-medium mb-4 text-gray-700">Imagen/Video</h4>
                <button id="cloudinary-upload-btn" class="w-full bg-blue-600 text-white p-4 rounded-2xl hover:bg-blue-700 transition-all font-medium mb-4">
                    <i class="fas fa-cloud-upload-alt mr-2"></i>Subir desde tu ordenador (Cloudinary)
                </button>
                <div class="text-center text-gray-500 mb-2">o</div>
                <input type="url" id="media-url" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none" placeholder="Pegar URL de imagen/video">
            </div>
            <div class="flex gap-4 pt-6">
                <button id="save-edit-btn" class="gradient-gold text-white px-6 py-3 rounded-2xl hover:shadow-lg transition-all font-medium">Guardar</button>
                <button id="cancel-edit-btn" class="bg-gray-500 text-white px-6 py-3 rounded-2xl hover:bg-gray-600 transition-all font-medium">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Add New Item Modal -->
    <div id="add-modal" class="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-3xl max-w-3xl w-full p-8 max-h-[90vh] overflow-y-auto shadow-2xl">
            <h3 class="text-2xl font-display font-bold mb-6 text-gray-800">Añadir Nuevo Elemento</h3>
            <div class="mb-6">
                <label class="block text-sm font-medium mb-2 text-gray-700">Tipo:</label>
                <select id="add-type" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none">
                    <option value="service">Servicio</option>
                    <option value="testimonial">Testimonio</option>
                    <option value="gallery">Imagen/Video Galería</option>
                </select>
            </div>
            <div id="add-content">
                <!-- Dynamic content based on type -->
            </div>
            <div class="flex gap-4 pt-6">
                <button id="save-add-btn" class="gradient-gold text-white px-6 py-3 rounded-2xl hover:shadow-lg transition-all font-medium">Añadir</button>
                <button id="cancel-add-btn" class="bg-gray-500 text-white px-6 py-3 rounded-2xl hover:bg-gray-600 transition-all font-medium">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- CMS Toolbar -->
    <div id="cms-toolbar" class="fixed top-0 left-0 right-0 z-[9999] bg-gray-900 text-white p-4 shadow-2xl hidden">
        <div class="max-w-7xl mx-auto flex flex-wrap justify-between items-center gap-4">
            <div class="flex items-center gap-4">
                <i class="fas fa-magic text-2xl text-yellow-400"></i>
                <h1 class="text-xl font-display font-bold">Modo Edición Activo</h1>
            </div>
            <div class="flex items-center gap-3 flex-wrap">
                <button id="save-all-btn" class="bg-green-600 px-4 py-2 rounded-xl hover:bg-green-700 transition-all">
                    <i class="fas fa-save mr-2"></i>Guardar Cambios
                </button>
                <button id="export-btn" class="bg-blue-600 px-4 py-2 rounded-xl hover:bg-blue-700 transition-all">
                    <i class="fas fa-download mr-2"></i>Exportar JSON
                </button>
                <button id="export-html-btn" class="bg-purple-600 px-4 py-2 rounded-xl hover:bg-purple-700 transition-all">
                    <i class="fas fa-code mr-2"></i>Exportar HTML
                </button>
                <button id="reset-all-btn" class="bg-orange-600 px-4 py-2 rounded-xl hover:bg-orange-700 transition-all">
                    <i class="fas fa-undo mr-2"></i>Restaurar
                </button>
                <button id="exit-admin-btn" class="bg-red-600 px-4 py-2 rounded-xl hover:bg-red-700 transition-all">
                    <i class="fas fa-sign-out-alt mr-2"></i>Salir Edición
                </button>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-30 bg-white/95 backdrop-blur-lg shadow-lg" style="margin-top: 0;">
        <div class="max-w-7xl mx-auto px-4 py-4" id="main-nav">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-4">
                    <div class="w-14 h-14 gradient-gold rounded-full flex items-center justify-center shadow-lg">
                        <i class="fas fa-theater-masks text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-display font-bold text-gray-800 editable" data-field="site-title">Fontanella Producciones<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></h1>
                        <p class="text-sm text-gray-600 font-medium editable" data-field="site-subtitle">Arte, Cuentos & Experiencias con Ane Miren<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
                    </div>
                </div>
                <div class="hidden lg:flex items-center gap-8">
                    <a href="#inicio" class="text-gray-700 hover:text-yellow-600 font-medium transition-colors">Inicio</a>
                    <a href="#servicios" class="text-gray-700 hover:text-yellow-600 font-medium transition-colors">Servicios</a>
                    <a href="#biografia" class="text-gray-700 hover:text-yellow-600 font-medium transition-colors">Biografía</a>
                    <a href="#galeria" class="text-gray-700 hover:text-yellow-600 font-medium transition-colors">Galería</a>
                    <a href="#testimonios" class="text-gray-700 hover:text-yellow-600 font-medium transition-colors">Testimonios</a>
                    <a href="#contacto" class="gradient-gold text-white px-6 py-2 rounded-full hover:shadow-lg transition-all font-medium">
                        <i class="fas fa-envelope mr-2"></i>Contacto
                    </a>
                    <button id="admin-btn" class="text-gray-400 hover:text-gray-600 transition-colors ml-4" title="Modo edición">
                        <i class="fas fa-cog text-lg"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="inicio" class="min-h-screen bg-gradient-to-br from-purple-900 via-violet-900 to-indigo-900 flex items-center relative pt-20">
        <div class="absolute inset-0 bg-black/30"></div>
        <div class="max-w-7xl mx-auto px-4 py-32 relative z-10">
            <div class="grid lg:grid-cols-2 gap-16 items-center">
                <div class="text-white space-y-8">
                    <div class="inline-block">
                        <span class="px-6 py-3 bg-white/10 backdrop-blur-lg rounded-full text-lg font-medium border border-white/30 editable" data-field="hero-badge">✨ Arte • Cuentos • Teatro • Música<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></span>
                    </div>
                    <h1 class="text-6xl lg:text-8xl font-display font-bold leading-tight editable" data-field="hero-title">Fontanella <span class="text-gradient">Producciones</span><div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></h1>
                    <h2 class="text-2xl lg:text-4xl font-light text-gray-200 editable" data-field="hero-subtitle">Creadora de Experiencias Transformadoras<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></h2>
                    <p class="text-xl text-gray-300 leading-relaxed max-w-2xl editable" data-field="hero-description">Transformo momentos cotidianos en experiencias extraordinarias a través del arte del teatro, los cuentos, la música y la creatividad.<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
                    <div class="flex flex-wrap gap-4">
                        <a href="tel:+34600627593" class="bg-green-600 text-white px-8 py-4 rounded-2xl hover:bg-green-700 transition-all font-medium text-lg shadow-lg">
                            <i class="fab fa-whatsapp mr-2"></i>WhatsApp
                        </a>
                        <a href="mailto:fontanellaproducciones@gmail.com" class="bg-white/10 backdrop-blur-lg text-white px-8 py-4 rounded-2xl hover:bg-white/20 transition-all font-medium text-lg border border-white/30">
                            <i class="fas fa-envelope mr-2"></i>Email
                        </a>
                    </div>
                </div>
                <div class="flex justify-center">
                    <div class="w-[450px] h-[450px] lg:w-[500px] lg:h-[500px] rounded-full overflow-hidden shadow-2xl border-8 border-white/30 floating editable" data-field="hero-image" data-type="image">
                        <img src="https://i.postimg.cc/DfQ2cLX8/2025-09-21-20-06-48.jpg" alt="Ane Miren Lafuente" class="w-full h-full object-cover">
                        <div class="edit-overlay"><i class="fas fa-camera"></i></div>
                        <div class="delete-overlay"><i class="fas fa-trash"></i></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section id="servicios" class="py-24 bg-gradient-to-br from-slate-50 via-white to-amber-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center mb-20">
                <span class="px-6 py-3 gradient-gold text-white rounded-full text-lg font-medium shadow-lg editable" data-field="services-badge">✨ Servicios Creativos<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></span>
                <h2 class="text-5xl lg:text-6xl font-display font-bold text-gray-800 mt-8 mb-6 editable" data-field="services-title">Experiencias que Transforman<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></h2>
                <p class="text-xl text-gray-600 max-w-4xl mx-auto leading-relaxed editable" data-field="services-description">Desde íntimos cuentacuentos hasta grandiosas producciones teatrales, cada servicio está diseñado para crear conexiones profundas y momentos inolvidables.<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
            </div>
            <div id="services-container" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
                <!-- Services will be loaded here -->
            </div>
            <button class="section-add-btn" onclick="openAddModal('service')">
                <i class="fas fa-plus mr-2"></i>Añadir Servicio
            </button>
        </div>
    </section>

    <!-- Palabra Viva Section -->
    <section class="py-16 bg-gradient-to-br from-purple-900 via-indigo-800 to-blue-900 relative overflow-hidden">
        <div class="absolute inset-0 opacity-10">
            <div class="absolute top-10 left-10 w-32 h-32 border border-white rounded-full"></div>
            <div class="absolute bottom-10 right-10 w-48 h-48 border border-white rounded-full"></div>
            <div class="absolute top-1/2 left-1/3 w-24 h-24 border border-white rounded-full"></div>
        </div>
        <div class="relative z-10 max-w-6xl mx-auto px-8 text-center text-white">
            <div class="inline-flex items-center justify-center w-24 h-24 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mb-8 shadow-2xl">
                <i class="fas fa-cross text-4xl text-white"></i>
            </div>
            <h2 class="text-6xl lg:text-7xl font-display font-bold mb-6 bg-gradient-to-r from-yellow-300 to-orange-300 bg-clip-text text-transparent editable" data-field="palabra-viva-title">PALABRA VIVA<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></h2>
            <h3 class="text-2xl lg:text-3xl font-light mb-8 text-gray-200 editable" data-field="palabra-viva-subtitle">Teatro Bíblico Transformador<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></h3>
            <p class="text-xl lg:text-2xl leading-relaxed mb-12 max-w-4xl mx-auto text-gray-100 editable" data-field="palabra-viva-description">Una metodología revolucionaria que hace viva la Palabra de Dios a través del arte teatral. Experiencias transformadoras que conectan corazones con lo divino mediante la evangelización experiencial.<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
            <div class="flex flex-wrap gap-6 justify-center">
                <a href="https://palabraviva-anemiren.netlify.app/" target="_blank" class="group bg-gradient-to-r from-yellow-400 to-orange-500 text-gray-900 px-8 py-4 rounded-2xl hover:shadow-2xl transition-all font-bold text-lg hover:scale-105">
                    <i class="fas fa-external-link-alt mr-2 group-hover:rotate-12 transition-transform"></i>Visitar Palabra Viva
                </a>
                <a href="tel:+34600627593" class="group bg-green-600 text-white px-8 py-4 rounded-2xl hover:bg-green-700 hover:shadow-2xl transition-all font-bold text-lg hover:scale-105">
                    <i class="fab fa-whatsapp mr-2"></i>Contactar
                </a>
            </div>
        </div>
    </section>

    <!-- Biography Section -->
    <section id="biografia" class="py-24 bg-gradient-to-br from-amber-50 via-orange-50 to-rose-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center mb-20">
                <span class="px-6 py-3 gradient-gold text-white rounded-full text-lg font-medium shadow-lg editable" data-field="bio-badge">🌟 Biografía<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></span>
                <h2 class="text-5xl lg:text-6xl font-display font-bold text-gray-800 mt-8 mb-6 editable" data-field="bio-title">La Historia Detrás del Arte<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></h2>
            </div>
            <div class="grid lg:grid-cols-2 gap-16 items-center">
                <div>
                    <div class="space-y-6 text-lg text-gray-700 leading-relaxed">
                        <p class="editable" data-field="bio-p1"><strong>Ane Miren Lafuente</strong> es una artista multidisciplinar con más de 15 años de experiencia en las artes escénicas. Su pasión por la narración nació en la infancia, cuando descubrió el poder transformador de las historias.<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
                        <p class="editable" data-field="bio-p2">Formada en Arte Dramático y Composición Musical, ha desarrollado un enfoque único que fusiona técnicas teatrales clásicas con innovación contemporánea.<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
                        <p class="editable" data-field="bio-p3">En 2018 fundó <strong>Fontanella Producciones</strong>, materializando su visión de crear experiencias artísticas que nutren el alma y conectan comunidades.<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
                    </div>
                    <div class="grid grid-cols-2 gap-6 mt-12">
                        <div class="text-center p-6 bg-white/70 rounded-2xl border border-yellow-100 editable" data-field="achievement-1">
                            <div class="text-3xl font-bold text-yellow-600 mb-2">500+</div>
                            <div class="text-gray-600 font-medium">Espectáculos</div>
                            <div class="edit-overlay"><i class="fas fa-edit"></i></div>
                            <div class="delete-overlay"><i class="fas fa-trash"></i></div>
                        </div>
                        <div class="text-center p-6 bg-white/70 rounded-2xl border border-orange-100 editable" data-field="achievement-2">
                            <div class="text-3xl font-bold text-orange-600 mb-2">50+</div>
                            <div class="text-gray-600 font-medium">Composiciones</div>
                            <div class="edit-overlay"><i class="fas fa-edit"></i></div>
                            <div class="delete-overlay"><i class="fas fa-trash"></i></div>
                        </div>
                        <div class="text-center p-6 bg-white/70 rounded-2xl border border-green-100 editable" data-field="achievement-3">
                            <div class="text-3xl font-bold text-green-600 mb-2">15</div>
                            <div class="text-gray-600 font-medium">Años Experiencia</div>
                            <div class="edit-overlay"><i class="fas fa-edit"></i></div>
                            <div class="delete-overlay"><i class="fas fa-trash"></i></div>
                        </div>
                        <div class="text-center p-6 bg-white/70 rounded-2xl border border-pink-100 editable" data-field="achievement-4">
                            <div class="text-3xl font-bold text-pink-600 mb-2">25+</div>
                            <div class="text-gray-600 font-medium">Premios</div>
                            <div class="edit-overlay"><i class="fas fa-edit"></i></div>
                            <div class="delete-overlay"><i class="fas fa-trash"></i></div>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="w-full h-[600px] rounded-3xl overflow-hidden shadow-2xl border-8 border-white/50 editable" data-field="bio-image" data-type="image">
                        <img src="https://i.postimg.cc/DfQ2cLX8/2025-09-21-20-06-48.jpg" alt="Ane Miren Lafuente - Biografía" class="w-full h-full object-cover">
                        <div class="edit-overlay"><i class="fas fa-camera"></i></div>
                        <div class="delete-overlay"><i class="fas fa-trash"></i></div>
                    </div>
                    <div class="mt-8 bg-white/70 backdrop-blur-lg rounded-2xl p-6 border border-amber-100">
                        <blockquote class="text-gray-800 font-display text-xl italic leading-relaxed editable" data-field="bio-quote">"El arte no es solo entretenimiento, es una herramienta de transformación que nos conecta con nuestra humanidad más profunda."<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></blockquote>
                        <cite class="text-gray-600 text-sm mt-2 block editable" data-field="bio-quote-author">- Ane Miren Lafuente<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></cite>
                        <div class="mt-6 text-center">
                            <a href="https://anemirenla.wixsite.com/misitio2" target="_blank" class="inline-flex items-center gradient-gold text-white px-6 py-3 rounded-2xl hover:shadow-lg transition-all font-medium">
                                <i class="fas fa-globe mr-2"></i>Visitar Web Principal
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Gallery Section -->
    <section id="galeria" class="py-24 bg-gradient-to-br from-slate-50 via-zinc-50 to-stone-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center mb-20">
                <span class="px-6 py-3 gradient-gold text-white rounded-full text-lg font-medium shadow-lg editable" data-field="gallery-badge">📸 Galería<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></span>
                <h2 class="text-5xl lg:text-6xl font-display font-bold text-gray-800 mt-8 mb-6 editable" data-field="gallery-title">Galería de Imágenes y Videos<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></h2>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed editable" data-field="gallery-description">Una colección visual de experiencias únicas, emociones auténticas y la magia que surge cuando el arte se encuentra con el corazón humano.<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
            </div>
            <div id="gallery-container" class="grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Gallery items will be loaded here -->
            </div>
            <button class="section-add-btn" onclick="openAddModal('gallery')">
                <i class="fas fa-plus mr-2"></i>Añadir Imagen/Video
            </button>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section id="testimonios" class="py-24 bg-gradient-to-br from-rose-50 via-pink-50 to-amber-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center mb-20">
                <span class="px-6 py-3 gradient-gold text-white rounded-full text-lg font-medium shadow-lg editable" data-field="testimonials-badge">💝 Testimonios<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></span>
                <h2 class="text-5xl lg:text-6xl font-display font-bold text-gray-800 mt-8 mb-6 editable" data-field="testimonials-title">Voces que Resuenan<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></h2>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed editable" data-field="testimonials-description">Las palabras de quienes han vivido la experiencia hablan por sí solas. Cada testimonio es una historia de transformación y conexión auténtica.<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
            </div>
            <div id="testimonials-container" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Testimonials will be loaded here -->
            </div>
            <button class="section-add-btn" onclick="openAddModal('testimonial')">
                <i class="fas fa-plus mr-2"></i>Añadir Testimonio
            </button>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contacto" class="py-24 bg-gradient-to-br from-violet-50 via-purple-50 to-amber-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center mb-20">
                <span class="px-6 py-3 gradient-gold text-white rounded-full text-lg font-medium shadow-lg editable" data-field="contact-badge">📞 Contacto<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></span>
                <h2 class="text-5xl lg:text-6xl font-display font-bold text-gray-800 mt-8 mb-6 editable" data-field="contact-title">Conectemos y Creemos Juntos<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></h2>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed editable" data-field="contact-description">Estoy aquí para escuchar tu visión y transformarla en una experiencia inolvidable. Hablemos sobre cómo podemos crear algo mágico juntos.<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
            </div>
            <div class="grid lg:grid-cols-2 gap-16">
                <div>
                    <h3 class="text-3xl font-display font-bold text-gray-800 mb-8">Información de Contacto</h3>
                    <div class="space-y-6">
                        <div class="flex items-center p-6 bg-white/70 rounded-2xl border border-yellow-100">
                            <div class="w-14 h-14 gradient-gold rounded-full flex items-center justify-center mr-6">
                                <i class="fab fa-whatsapp text-white text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-gray-800 text-lg">WhatsApp</h4>
                                <a href="tel:+34600627593" class="text-gray-600 hover:text-yellow-600 transition-colors">+34 600 627 593</a>
                            </div>
                        </div>
                        <div class="flex items-center p-6 bg-white/70 rounded-2xl border border-yellow-100">
                            <div class="w-14 h-14 gradient-gold rounded-full flex items-center justify-center mr-6">
                                <i class="fas fa-envelope text-white text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-gray-800 text-lg">Email</h4>
                                <a href="mailto:fontanellaproducciones@gmail.com" class="text-gray-600 hover:text-yellow-600 transition-colors break-all">fontanellaproducciones@gmail.com</a>
                            </div>
                        </div>
                        <div class="flex items-center p-6 bg-white/70 rounded-2xl border border-yellow-100">
                            <div class="w-14 h-14 gradient-gold rounded-full flex items-center justify-center mr-6">
                                <i class="fas fa-link text-white text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-gray-800 text-lg">Enlaces</h4>
                                <a href="https://www.atom.bio/fontanella" target="_blank" class="text-gray-600 hover:text-yellow-600 transition-colors">atom.bio/fontanella</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="bg-white/70 rounded-3xl p-8 border border-yellow-100">
                        <h3 class="text-3xl font-display font-bold text-gray-800 mb-6">Mensaje Rápido</h3>
                        <form class="space-y-6" id="contact-form">
                            <div>
                                <input type="text" required class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none" placeholder="Tu nombre">
                            </div>
                            <div>
                                <input type="email" required class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none" placeholder="tu@email.com">
                            </div>
                            <div>
                                <textarea required class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none h-32 resize-none" placeholder="Cuéntame sobre tu proyecto..."></textarea>
                            </div>
                            <button type="submit" class="w-full gradient-gold text-white py-4 rounded-2xl hover:shadow-lg transition-all font-medium text-lg">Enviar Mensaje</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-16">
        <div class="max-w-7xl mx-auto px-4">
            <div class="grid md:grid-cols-4 gap-8 mb-12">
                <div class="md:col-span-2">
                    <div class="flex items-center gap-4 mb-6">
                        <div class="w-12 h-12 gradient-gold rounded-full flex items-center justify-center">
                            <i class="fas fa-theater-masks text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-display font-bold editable" data-field="footer-title">Fontanella Producciones<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></h3>
                            <p class="text-gray-400 editable" data-field="footer-subtitle">Arte, Cuentos & Experiencias<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
                        </div>
                    </div>
                    <p class="text-gray-300 leading-relaxed mb-6 editable" data-field="footer-description">Transformando momentos cotidianos en experiencias extraordinarias a través del arte del teatro, los cuentos, la música y la creatividad.<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
                    <div class="flex gap-4">
                        <a href="tel:+34600627593" class="w-10 h-10 bg-green-600 rounded-full flex items-center justify-center hover:bg-green-700 transition-all">
                            <i class="fab fa-whatsapp"></i>
                        </a>
                        <a href="mailto:fontanellaproducciones@gmail.com" class="w-10 h-10 bg-yellow-600 rounded-full flex items-center justify-center hover:bg-yellow-700 transition-all">
                            <i class="fas fa-envelope"></i>
                        </a>
                        <a href="https://www.atom.bio/fontanella" target="_blank" class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center hover:bg-blue-700 transition-all">
                            <i class="fas fa-link"></i>
                        </a>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-display font-bold mb-6">Enlaces Rápidos</h4>
                    <ul class="space-y-3">
                        <li><a href="#inicio" class="text-gray-300 hover:text-yellow-400 transition-colors">Inicio</a></li>
                        <li><a href="#servicios" class="text-gray-300 hover:text-yellow-400 transition-colors">Servicios</a></li>
                        <li><a href="#biografia" class="text-gray-300 hover:text-yellow-400 transition-colors">Biografía</a></li>
                        <li><a href="#galeria" class="text-gray-300 hover:text-yellow-400 transition-colors">Galería</a></li>
                        <li><a href="#testimonios" class="text-gray-300 hover:text-yellow-400 transition-colors">Testimonios</a></li>
                        <li><a href="#contacto" class="text-gray-300 hover:text-yellow-400 transition-colors">Contacto</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-display font-bold mb-6">Servicios Destacados</h4>
                    <ul class="space-y-3">
                        <li><a href="#servicios" class="text-gray-300 hover:text-yellow-400 transition-colors">Cuentacuentos</a></li>
                        <li><a href="#servicios" class="text-gray-300 hover:text-yellow-400 transition-colors">Teatro & Títeres</a></li>
                        <li><a href="#servicios" class="text-gray-300 hover:text-yellow-400 transition-colors">Composición Musical</a></li>
                        <li><a href="#servicios" class="text-gray-300 hover:text-yellow-400 transition-colors">Clases de Teatro</a></li>
                        <li><a href="https://palabraviva-anemiren.netlify.app/" target="_blank" class="text-gray-300 hover:text-yellow-400 transition-colors">Palabra Viva</a></li>
                        <li><a href="https://anemirenla.wixsite.com/misitio2" target="_blank" class="text-gray-300 hover:text-yellow-400 transition-colors">Web Principal</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                    <p class="text-gray-400 text-sm editable" data-field="copyright">© 2025 Fontanella Producciones - Ane Miren Lafuente. Todos los derechos reservados.<div class="edit-overlay"><i class="fas fa-edit"></i></div><div class="delete-overlay"><i class="fas fa-trash"></i></div></p>
                    <div class="flex gap-6 text-sm">
                        <a href="https://anemirenla.wixsite.com/misitio2" target="_blank" class="text-gray-400 hover:text-yellow-400 transition-colors">Web Principal</a>
                        <a href="https://palabraviva-anemiren.netlify.app/" target="_blank" class="text-gray-400 hover:text-yellow-400 transition-colors">Palabra Viva</a>
                        <a href="https://www.atom.bio/fontanella" target="_blank" class="text-gray-400 hover:text-yellow-400 transition-colors">Enlaces</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Cloudinary Configuration
        const CLOUDINARY_CLOUD_NAME = 'dgqxttarn';
        const CLOUDINARY_UPLOAD_PRESET = 'fontanella_uploads';
        
        // Helper function to upload to Cloudinary using fetch API
        async function uploadToCloudinary(file) {
            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
            
            try {
                const response = await fetch(
                    `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/upload`,
                    {
                        method: 'POST',
                        body: formData
                    }
                );
                
                const data = await response.json();
                if (data.secure_url) {
                    return data.secure_url;
                } else {
                    throw new Error('Upload failed');
                }
            } catch (error) {
                console.error('Cloudinary upload error:', error);
                throw error;
            }
        }
        
        let isAdminMode = false;
        let currentElement = null;
        let elementToDelete = null;
        let cloudinaryWidget = null;
        let addModalType = null;

        // Default content structure
        const defaultContent = {
            services: [
                {
                    id: 'service-1',
                    emoji: '📚',
                    title: 'Cuentacuentos Clásicos',
                    description: 'Relatos atemporales adaptados con técnicas teatrales innovadoras. Cada sesión incluye interacción, música en vivo y elementos sorpresa.'
                },
                {
                    id: 'service-2',
                    emoji: '👶',
                    title: 'Bebecuentos Sensoriales',
                    description: 'Experiencias multisensoriales para bebés de 0 a 3 años. Combinamos música suave, texturas y narrativa adaptada.'
                },
                {
                    id: 'service-3',
                    emoji: '🎭',
                    title: 'Teatro & Títeres',
                    description: 'Espectáculos completos con títeres artesanales, escenografía original y banda sonora en vivo.'
                },
                {
                    id: 'service-4',
                    emoji: '🎵',
                    title: 'Composición Musical',
                    description: 'Canciones originales, bandas sonoras y jingles personalizados para cualquier ocasión especial.'
                },
                {
                    id: 'service-5',
                    emoji: '🎪',
                    title: 'Clases de Teatro',
                    description: 'Formación teatral integral para todas las edades. Desarrollo de habilidades interpretativas y expresión corporal.'
                },
                {
                    id: 'service-6',
                    emoji: '✨',
                    title: 'Palabra Viva',
                    description: 'Teatro bíblico transformador que hace viva la Palabra de Dios a través del arte teatral.'
                }
            ],
            testimonials: [
                {
                    id: 'testimonial-1',
                    initials: 'MJ',
                    color: 'yellow',
                    name: 'María José Rodríguez',
                    role: 'Directora Colegio',
                    text: '"Ane Miren transformó por completo la percepción de nuestros estudiantes sobre el teatro. Su metodología única logró que niños tímidos se convirtieran en pequeños artistas seguros."'
                },
                {
                    id: 'testimonial-2',
                    initials: 'CL',
                    color: 'pink',
                    name: 'Carmen López',
                    role: 'Madre de familia',
                    text: '"Los bebecuentos de Ane Miren fueron mágicos para mi hija de 18 meses. La forma en que conectó con ella a través de la música y los gestos fue extraordinaria."'
                },
                {
                    id: 'testimonial-3',
                    initials: 'JM',
                    color: 'green',
                    name: 'Padre José Miguel',
                    role: 'Párroco San Andrés',
                    text: '"El proyecto \'Palabra Viva\' ha revolucionado nuestra forma de evangelizar. Ane Miren logró que las Escrituras cobraran vida de una manera que nunca habíamos experimentado."'
                }
            ],
            gallery: [
                {
                    id: 'gallery-1',
                    type: 'image',
                    url: 'https://i.postimg.cc/DfQ2cLX8/2025-09-21-20-06-48.jpg',
                    title: 'Espectáculo Teatro',
                    subtitle: 'Teatro Municipal'
                },
                {
                    id: 'gallery-2',
                    type: 'image',
                    url: 'https://i.postimg.cc/DfQ2cLX8/2025-09-21-20-06-48.jpg',
                    title: 'Cuentacuentos',
                    subtitle: 'Biblioteca Central'
                },
                {
                    id: 'gallery-3',
                    type: 'video',
                    url: 'https://res.cloudinary.com/demo/video/upload/dog.mp4',
                    title: 'Video Demo',
                    subtitle: 'Haz clic para editar'
                },
                {
                    id: 'gallery-4',
                    type: 'image',
                    url: 'https://i.postimg.cc/DfQ2cLX8/2025-09-21-20-06-48.jpg',
                    title: 'Taller de Teatro',
                    subtitle: 'Centro Cultural'
                }
            ]
        };

        document.addEventListener('DOMContentLoaded', () => {
            loadSavedContent();
            setupEventListeners();
            initializeCloudinary();
            renderDynamicContent();
        });

        function setupEventListeners() {
            document.getElementById('admin-btn').addEventListener('click', () => document.getElementById('login-modal').classList.remove('hidden'));
            document.getElementById('login-btn').addEventListener('click', login);
            document.getElementById('admin-password').addEventListener('keypress', e => {
                if (e.key === 'Enter') login();
            });
            document.getElementById('cancel-login-btn').addEventListener('click', () => {
                document.getElementById('login-modal').classList.add('hidden');
                document.getElementById('admin-password').value = '';
                document.getElementById('login-error').classList.add('hidden');
            });
            
            document.getElementById('exit-admin-btn').addEventListener('click', exitAdminMode);
            document.getElementById('save-all-btn').addEventListener('click', saveAllContent);
            document.getElementById('export-btn').addEventListener('click', exportData);
            document.getElementById('export-html-btn').addEventListener('click', exportHTML);
            document.getElementById('reset-all-btn').addEventListener('click', resetAllContent);
            
            document.getElementById('save-edit-btn').addEventListener('click', saveEdit);
            document.getElementById('cancel-edit-btn').addEventListener('click', closeEditModal);
            
            document.getElementById('confirm-delete-btn').addEventListener('click', confirmDelete);
            document.getElementById('cancel-delete-btn').addEventListener('click', closeDeleteModal);
            
            document.getElementById('save-add-btn').addEventListener('click', saveNewItem);
            document.getElementById('cancel-add-btn').addEventListener('click', closeAddModal);
            document.getElementById('add-type').addEventListener('change', updateAddModalContent);
            
            document.getElementById('cloudinary-upload-btn').addEventListener('click', openCloudinaryWidget);
            
            document.addEventListener('click', e => {
                if (!isAdminMode) return;
                
                const editable = e.target.closest('.editable');
                if (!editable) return;
                
                if (e.target.closest('.delete-overlay')) {
                    e.stopPropagation();
                    openDeleteModal(editable);
                    return;
                }
                
                if (e.target.closest('.edit-overlay') || editable) {
                    e.stopPropagation();
                    openEditModal(editable);
                }
            });
        }

        function initializeCloudinary() {
            // Cloudinary will be used via API, no widget needed
            console.log('Cloudinary ready via API');
        }

        function openCloudinaryWidget() {
            // Create file input for direct upload
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*,video/*';
            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                showNotification('Subiendo archivo...', 'warning');
                
                try {
                    const url = await uploadToCloudinary(file);
                    document.getElementById('media-url').value = url;
                    showNotification('Archivo subido correctamente', 'success');
                } catch (error) {
                    showNotification('Error al subir archivo', 'error');
                }
            };
            input.click();
        }

        function login() {
            const password = document.getElementById('admin-password').value;
            
            if (password === 'fontanella2025') {
                isAdminMode = true;
                document.body.classList.add('admin-mode');
                
                // Show toolbar and adjust navigation
                const toolbar = document.getElementById('cms-toolbar');
                toolbar.classList.remove('hidden');
                
                const mainNav = document.getElementById('main-nav');
                mainNav.style.marginTop = '72px';
                
                document.getElementById('login-modal').classList.add('hidden');
                document.getElementById('admin-password').value = '';
                document.getElementById('login-error').classList.add('hidden');
                
                showNotification('✓ Modo edición activado - Usa los botones de arriba para guardar', 'success');
            } else {
                document.getElementById('login-error').classList.remove('hidden');
            }
        }

        function exitAdminMode() {
            isAdminMode = false;
            document.body.classList.remove('admin-mode');
            
            // Hide toolbar and reset navigation
            const toolbar = document.getElementById('cms-toolbar');
            toolbar.classList.add('hidden');
            
            const mainNav = document.getElementById('main-nav');
            mainNav.style.marginTop = '0';
            
            showNotification('Modo edición desactivado', 'warning');
        }

        function openEditModal(element) {
            currentElement = element;
            const type = element.dataset.type;
            
            document.getElementById('edit-modal').classList.remove('hidden');
            
            if (type === 'image' || type === 'gallery') {
                const img = element.querySelector('img');
                const video = element.querySelector('video source');
                
                if (img) {
                    document.getElementById('media-url').value = img.src;
                } else if (video) {
                    document.getElementById('media-url').value = video.src;
                }
            } else if (type === 'service') {
                // Edit service - get data from dynamicContent
                const serviceId = element.dataset.serviceId;
                const content = JSON.parse(localStorage.getItem('dynamicContent') || JSON.stringify(defaultContent));
                const service = content.services.find(s => s.id === serviceId);
                
                if (service) {
                    document.getElementById('edit-textarea').value = `${service.emoji}\n${service.title}\n${service.description}`;
                }
            } else if (type === 'testimonial') {
                // Edit testimonial
                const testimonialId = element.dataset.testimonialId;
                const content = JSON.parse(localStorage.getItem('dynamicContent') || JSON.stringify(defaultContent));
                const testimonial = content.testimonials.find(t => t.id === testimonialId);
                
                if (testimonial) {
                    document.getElementById('edit-textarea').value = `${testimonial.initials}\n${testimonial.name}\n${testimonial.role}\n${testimonial.text}`;
                }
            } else {
                // Regular text content
                const textContent = element.cloneNode(true);
                textContent.querySelectorAll('.edit-overlay, .delete-overlay').forEach(overlay => overlay.remove());
                document.getElementById('edit-textarea').value = textContent.textContent.trim();
            }
        }

        function closeEditModal() {
            document.getElementById('edit-modal').classList.add('hidden');
            document.getElementById('edit-textarea').value = '';
            document.getElementById('media-url').value = '';
            currentElement = null;
        }

        function saveEdit() {
            if (!currentElement) return;
            
            const type = currentElement.dataset.type;
            
            if (type === 'image') {
                const url = document.getElementById('media-url').value;
                const img = currentElement.querySelector('img');
                if (url && img) img.src = url;
            } else if (type === 'gallery') {
                // Save gallery item changes
                const url = document.getElementById('media-url').value;
                const galleryId = currentElement.dataset.galleryId;
                
                if (url && galleryId) {
                    const content = JSON.parse(localStorage.getItem('dynamicContent') || JSON.stringify(defaultContent));
                    const galleryItem = content.gallery.find(g => g.id === galleryId);
                    
                    if (galleryItem) {
                        galleryItem.url = url;
                        localStorage.setItem('dynamicContent', JSON.stringify(content));
                        renderDynamicContent();
                    }
                }
            } else if (type === 'service') {
                // Save service changes
                const serviceId = currentElement.dataset.serviceId;
                const text = document.getElementById('edit-textarea').value;
                const lines = text.split('\n').filter(l => l.trim());
                
                if (serviceId && lines.length >= 3) {
                    const content = JSON.parse(localStorage.getItem('dynamicContent') || JSON.stringify(defaultContent));
                    const service = content.services.find(s => s.id === serviceId);
                    
                    if (service) {
                        service.emoji = lines[0].trim();
                        service.title = lines[1].trim();
                        service.description = lines.slice(2).join(' ').trim();
                        localStorage.setItem('dynamicContent', JSON.stringify(content));
                        renderDynamicContent();
                    }
                }
            } else if (type === 'testimonial') {
                // Save testimonial changes
                const testimonialId = currentElement.dataset.testimonialId;
                const text = document.getElementById('edit-textarea').value;
                const lines = text.split('\n').filter(l => l.trim());
                
                if (testimonialId && lines.length >= 4) {
                    const content = JSON.parse(localStorage.getItem('dynamicContent') || JSON.stringify(defaultContent));
                    const testimonial = content.testimonials.find(t => t.id === testimonialId);
                    
                    if (testimonial) {
                        testimonial.initials = lines[0].trim();
                        testimonial.name = lines[1].trim();
                        testimonial.role = lines[2].trim();
                        testimonial.text = lines.slice(3).join(' ').trim();
                        localStorage.setItem('dynamicContent', JSON.stringify(content));
                        renderDynamicContent();
                    }
                }
            } else {
                // Regular text content
                const newText = document.getElementById('edit-textarea').value;
                const overlays = Array.from(currentElement.querySelectorAll('.edit-overlay, .delete-overlay'));
                currentElement.innerHTML = '';
                currentElement.textContent = newText;
                overlays.forEach(overlay => currentElement.appendChild(overlay.cloneNode(true)));
            }
            
            closeEditModal();
            showNotification('Contenido actualizado', 'success');
        }

        function openDeleteModal(element) {
            elementToDelete = element;
            document.getElementById('delete-modal').classList.remove('hidden');
        }

        function closeDeleteModal() {
            document.getElementById('delete-modal').classList.add('hidden');
            elementToDelete = null;
        }

        function confirmDelete() {
            if (!elementToDelete) return;
            
            const field = elementToDelete.dataset.field;
            const placeholder = document.createElement('div');
            placeholder.className = 'deleted-placeholder';
            placeholder.innerHTML = `<i class="fas fa-trash-alt text-4xl mb-2"></i><p class="font-bold">Eliminado</p><p class="text-sm">${field}</p>`;
            
            elementToDelete.replaceWith(placeholder);
            
            const deletedItems = JSON.parse(localStorage.getItem('deletedItems') || '[]');
            deletedItems.push(field);
            localStorage.setItem('deletedItems', JSON.stringify(deletedItems));
            
            closeDeleteModal();
            showNotification('Elemento eliminado', 'success');
        }

        function openAddModal(type) {
            addModalType = type;
            document.getElementById('add-modal').classList.remove('hidden');
            updateAddModalContent();
        }

        function closeAddModal() {
            document.getElementById('add-modal').classList.add('hidden');
            addModalType = null;
            document.getElementById('add-content').innerHTML = '';
        }

        function updateAddModalContent() {
            const type = document.getElementById('add-type').value;
            const container = document.getElementById('add-content');
            
            if (type === 'service') {
                container.innerHTML = `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Emoji:</label>
                            <input type="text" id="new-emoji" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none" placeholder="🎭">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Título:</label>
                            <input type="text" id="new-title" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none" placeholder="Nombre del servicio">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Descripción:</label>
                            <textarea id="new-description" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none h-32 resize-none" placeholder="Descripción del servicio..."></textarea>
                        </div>
                    </div>
                `;
            } else if (type === 'testimonial') {
                container.innerHTML = `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Iniciales:</label>
                            <input type="text" id="new-initials" maxlength="2" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none" placeholder="MJ">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Color:</label>
                            <select id="new-color" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none">
                                <option value="yellow">Amarillo</option>
                                <option value="pink">Rosa</option>
                                <option value="green">Verde</option>
                                <option value="blue">Azul</option>
                                <option value="purple">Morado</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Nombre:</label>
                            <input type="text" id="new-name" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none" placeholder="María López">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Rol:</label>
                            <input type="text" id="new-role" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none" placeholder="Directora Colegio">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Testimonio:</label>
                            <textarea id="new-text" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none h-32 resize-none" placeholder="El testimonio..."></textarea>
                        </div>
                    </div>
                `;
            } else if (type === 'gallery') {
                container.innerHTML = `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Tipo:</label>
                            <select id="new-media-type" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none">
                                <option value="image">Imagen</option>
                                <option value="video">Video</option>
                            </select>
                        </div>
                        <div>
                            <button id="cloudinary-upload-add-btn" class="w-full bg-blue-600 text-white p-4 rounded-2xl hover:bg-blue-700 transition-all font-medium mb-4">
                                <i class="fas fa-cloud-upload-alt mr-2"></i>Subir desde tu ordenador (Cloudinary)
                            </button>
                            <div class="text-center text-gray-500 mb-2">o</div>
                            <input type="url" id="new-url" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none" placeholder="URL de imagen/video">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Título:</label>
                            <input type="text" id="new-gallery-title" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none" placeholder="Título">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Subtítulo:</label>
                            <input type="text" id="new-subtitle" class="w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-yellow-500 focus:outline-none" placeholder="Subtítulo">
                        </div>
                    </div>
                `;
                
                setTimeout(() => {
                    document.getElementById('cloudinary-upload-add-btn').addEventListener('click', async () => {
                        const input = document.createElement('input');
                        input.type = 'file';
                        input.accept = 'image/*,video/*';
                        input.onchange = async (e) => {
                            const file = e.target.files[0];
                            if (!file) return;
                            
                            showNotification('Subiendo archivo...', 'warning');
                            
                            try {
                                const url = await uploadToCloudinary(file);
                                document.getElementById('new-url').value = url;
                                showNotification('Archivo subido correctamente', 'success');
                            } catch (error) {
                                showNotification('Error al subir archivo', 'error');
                            }
                        };
                        input.click();
                    });
                }, 100);
            }
        }

        function saveNewItem() {
            const type = document.getElementById('add-type').value;
            const content = JSON.parse(localStorage.getItem('dynamicContent') || JSON.stringify(defaultContent));
            
            if (type === 'service') {
                const newService = {
                    id: 'service-' + Date.now(),
                    emoji: document.getElementById('new-emoji').value,
                    title: document.getElementById('new-title').value,
                    description: document.getElementById('new-description').value
                };
                content.services.push(newService);
            } else if (type === 'testimonial') {
                const newTestimonial = {
                    id: 'testimonial-' + Date.now(),
                    initials: document.getElementById('new-initials').value,
                    color: document.getElementById('new-color').value,
                    name: document.getElementById('new-name').value,
                    role: document.getElementById('new-role').value,
                    text: document.getElementById('new-text').value
                };
                content.testimonials.push(newTestimonial);
            } else if (type === 'gallery') {
                const newGallery = {
                    id: 'gallery-' + Date.now(),
                    type: document.getElementById('new-media-type').value,
                    url: document.getElementById('new-url').value,
                    title: document.getElementById('new-gallery-title').value,
                    subtitle: document.getElementById('new-subtitle').value
                };
                content.gallery.push(newGallery);
            }
            
            localStorage.setItem('dynamicContent', JSON.stringify(content));
            renderDynamicContent();
            closeAddModal();
            showNotification('Elemento añadido correctamente', 'success');
        }

        function renderDynamicContent() {
            const content = JSON.parse(localStorage.getItem('dynamicContent') || JSON.stringify(defaultContent));
            
            // Render Services
            const servicesContainer = document.getElementById('services-container');
            servicesContainer.innerHTML = content.services.map(service => `
                <div class="service-card p-8 editable" data-field="${service.id}" data-type="service" data-service-id="${service.id}">
                    <div class="text-4xl mb-4">${service.emoji}</div>
                    <h4 class="text-2xl font-display font-bold text-gray-800 mb-4">${service.title}</h4>
                    <p class="text-gray-600 leading-relaxed">${service.description}</p>
                    <div class="edit-overlay"><i class="fas fa-edit"></i></div>
                    <div class="delete-overlay" onclick="deleteDynamicItem('service', '${service.id}')"><i class="fas fa-trash"></i></div>
                </div>
            `).join('');
            
            // Render Testimonials
            const testimonialsContainer = document.getElementById('testimonials-container');
            testimonialsContainer.innerHTML = content.testimonials.map(testimonial => `
                <div class="testimonial-card p-8 editable" data-field="${testimonial.id}" data-type="testimonial" data-testimonial-id="${testimonial.id}">
                    <div class="flex items-center mb-6">
                        <div class="w-12 h-12 bg-${testimonial.color}-400 rounded-full flex items-center justify-center mr-4">
                            <span class="text-white font-bold text-lg">${testimonial.initials}</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-800">${testimonial.name}</h4>
                            <p class="text-gray-600 text-sm">${testimonial.role}</p>
                        </div>
                    </div>
                    <p class="text-gray-700 leading-relaxed">${testimonial.text}</p>
                    <div class="edit-overlay"><i class="fas fa-edit"></i></div>
                    <div class="delete-overlay" onclick="deleteDynamicItem('testimonial', '${testimonial.id}')"><i class="fas fa-trash"></i></div>
                </div>
            `).join('');
            
            // Render Gallery
            const galleryContainer = document.getElementById('gallery-container');
            galleryContainer.innerHTML = content.gallery.map(item => `
                <div class="gallery-item editable" data-field="${item.id}" data-type="gallery" data-gallery-id="${item.id}">
                    ${item.type === 'image' ? 
                        `<img src="${item.url}" alt="${item.title}" class="w-full h-64 object-cover">` :
                        `<video controls><source src="${item.url}" type="video/mp4"></video>`
                    }
                    <div class="gallery-overlay">
                        <div class="text-white">
                            <h4 class="font-display font-bold text-lg">${item.title}</h4>
                            <p class="text-sm opacity-90">${item.subtitle}</p>
                        </div>
                    </div>
                    <div class="edit-overlay"><i class="fas fa-${item.type === 'image' ? 'camera' : 'video'}"></i></div>
                    <div class="delete-overlay" onclick="deleteDynamicItem('gallery', '${item.id}')"><i class="fas fa-trash"></i></div>
                </div>
            `).join('');
        }

        function deleteDynamicItem(type, id) {
            if (!isAdminMode) return;
            
            if (confirm('¿Eliminar este elemento?')) {
                const content = JSON.parse(localStorage.getItem('dynamicContent') || JSON.stringify(defaultContent));
                
                if (type === 'service') {
                    content.services = content.services.filter(s => s.id !== id);
                } else if (type === 'testimonial') {
                    content.testimonials = content.testimonials.filter(t => t.id !== id);
                } else if (type === 'gallery') {
                    content.gallery = content.gallery.filter(g => g.id !== id);
                }
                
                localStorage.setItem('dynamicContent', JSON.stringify(content));
                renderDynamicContent();
                showNotification('Elemento eliminado', 'success');
            }
        }

        function saveAllContent() {
            const content = {};
            
            document.querySelectorAll('.editable').forEach(el => {
                const field = el.dataset.field;
                const type = el.dataset.type;
                
                if (type === 'image' || type === 'gallery') {
                    const img = el.querySelector('img');
                    const video = el.querySelector('video source');
                    content[field] = {
                        type,
                        url: img ? img.src : (video ? video.src : '')
                    };
                } else {
                    // Remove overlay elements before getting text
                    const textContent = el.cloneNode(true);
                    textContent.querySelectorAll('.edit-overlay, .delete-overlay').forEach(overlay => overlay.remove());
                    content[field] = {
                        type: 'text',
                        text: textContent.textContent.trim()
                    };
                }
            });
            
            localStorage.setItem('siteContent', JSON.stringify(content));
            
            const timestamp = new Date().toLocaleString('es-ES');
            showNotification(`✓ Cambios guardados exitosamente (${timestamp})`, 'success');
        }

        function loadSavedContent() {
            const saved = localStorage.getItem('siteContent');
            const deletedItems = JSON.parse(localStorage.getItem('deletedItems') || '[]');
            
            if (saved) {
                const content = JSON.parse(saved);
                Object.keys(content).forEach(field => {
                    const element = document.querySelector(`[data-field="${field}"]`);
                    if (!element) return;
                    
                    if (deletedItems.includes(field)) {
                        const placeholder = document.createElement('div');
                        placeholder.className = 'deleted-placeholder';
                        placeholder.innerHTML = `<i class="fas fa-trash-alt text-4xl mb-2"></i><p class="font-bold">Eliminado</p><p class="text-sm">${field}</p>`;
                        element.replaceWith(placeholder);
                        return;
                    }
                    
                    const data = content[field];
                    
                    if (data.type === 'image' || data.type === 'gallery') {
                        const img = element.querySelector('img');
                        const video = element.querySelector('video source');
                        
                        if (img && data.url) img.src = data.url;
                        if (video && data.url) {
                            video.src = data.url;
                            video.parentElement.load();
                        }
                    } else if (data.text) {
                        const overlays = Array.from(element.querySelectorAll('.edit-overlay, .delete-overlay'));
                        element.innerHTML = '';
                        element.textContent = data.text;
                        overlays.forEach(overlay => element.appendChild(overlay.cloneNode(true)));
                    }
                });
            }
        }

        function exportData() {
            const content = {};
            document.querySelectorAll('.editable').forEach(el => {
                const field = el.dataset.field;
                const type = el.dataset.type;
                
                if (type === 'image' || type === 'gallery') {
                    const img = el.querySelector('img');
                    const video = el.querySelector('video source');
                    content[field] = {
                        type,
                        url: img ? img.src : (video ? video.src : '')
                    };
                } else {
                    content[field] = {
                        type: 'text',
                        text: el.innerText
                    };
                }
            });
            
            const exportData = {
                content,
                dynamicContent: JSON.parse(localStorage.getItem('dynamicContent') || JSON.stringify(defaultContent)),
                deletedItems: JSON.parse(localStorage.getItem('deletedItems') || '[]'),
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'fontanella-' + Date.now() + '.json';
            a.click();
            
            showNotification('JSON exportado correctamente', 'success');
        }

        function exportHTML() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'fontanella-' + Date.now() + '.html';
            a.click();
            
            showNotification('HTML exportado correctamente', 'success');
        }

        function resetAllContent() {
            if (confirm('¿Estás seguro de que quieres restaurar todo el contenido original? Esta acción no se puede deshacer.')) {
                if (confirm('CONFIRMACIÓN FINAL: Se perderán todos los cambios. ¿Continuar?')) {
                    localStorage.removeItem('siteContent');
                    localStorage.removeItem('dynamicContent');
                    localStorage.removeItem('deletedItems');
                    location.reload();
                    showNotification('Contenido restaurado', 'success');
                }
            }
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} mr-2"></i>${message}`;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }
    </script>
</body>
</html>